<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤</title>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #1e1e1e;
            color: #e0e0e0;
        }
        h1 {
            color: #60a5fa;
        }
        button {
            padding: 15px 30px;
            font-size: 16px;
            background: #3b82f6;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            margin: 20px 0;
        }
        button:hover {
            background: #2563eb;
        }
        #status {
            margin-top: 20px;
            padding: 15px;
            background: #262626;
            border-radius: 6px;
            border: 1px solid #444;
        }
        .success {
            color: #22c55e;
        }
        .info {
            background: #1a1a1a;
            padding: 15px;
            border-radius: 6px;
            margin: 20px 0;
            border-left: 4px solid #3b82f6;
        }
    </style>
</head>
<body>
    <h1>üì¶ –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤ –¥–ª—è Version Inventory</h1>
    
    <div class="info">
        <p>–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞—Å—Ç 3 —Ç–µ—Å—Ç–æ–≤—ã—Ö Excel —Ñ–∞–π–ª–∞:</p>
        <ul>
            <li><strong>ibm-products.xlsx</strong> ‚Äî –ø—Ä–∏–º–µ—Ä—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è IBM –ø—Ä–æ–¥—É–∫—Ç–æ–≤</li>
            <li><strong>default-inventory.xlsx</strong> ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏—è</li>
            <li><strong>mixed-services.xlsx</strong> ‚Äî —Å–º–µ—à–∞–Ω–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã</li>
        </ul>
        <p>–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —Ñ–∞–π–ª—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫–∞—á–∞—é—Ç—Å—è. –ü–µ—Ä–µ–º–µ—Å—Ç–∏ –∏—Ö –≤ –ø–∞–ø–∫—É <code>test-files/</code> –ø—Ä–æ–µ–∫—Ç–∞.</p>
    </div>
    
    <button onclick="createTestFiles()">üöÄ –°–æ–∑–¥–∞—Ç—å –≤—Å–µ —Ç–µ—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã</button>
    <div id="status"></div>

    <script>
        function createTestFiles() {
            const status = document.getElementById('status');
            status.innerHTML = '<p>‚è≥ –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤...</p>';

            try {
                // 1. IBM Products
                const ibmProducts = {
                    'WebSphere Servers': [
                        ['Server Name', 'IP Address', 'Environment', 'Product', 'Version', 'Port', 'Status'],
                        ['WAS-PROD-01', '192.168.1.10', 'Production', 'WebSphere Application Server', '9.0.5.12', '9080', 'Running'],
                        ['WAS-PROD-02', '192.168.1.11', 'Production', 'WebSphere Application Server', '9.0.5.12', '9080', 'Running'],
                        ['WAS-TEST-01', '192.168.2.10', 'Testing', 'WebSphere Application Server', '9.0.5.10', '9080', 'Running'],
                        ['WAS-DEV-01', '192.168.3.10', 'Development', 'WebSphere Application Server', '9.0.5.8', '9080', 'Running']
                    ],
                    'DB2 Databases': [
                        ['Server Name', 'IP Address', 'Environment', 'Product', 'Version', 'Database Name', 'Status'],
                        ['DB2-PROD-01', '192.168.1.20', 'Production', 'IBM DB2', '11.5.7.0', 'PROD_DB', 'Running'],
                        ['DB2-PROD-02', '192.168.1.21', 'Production', 'IBM DB2', '11.5.7.0', 'PROD_DB2', 'Running'],
                        ['DB2-TEST-01', '192.168.2.20', 'Testing', 'IBM DB2', '11.5.6.0', 'TEST_DB', 'Running']
                    ],
                    'MQ Servers': [
                        ['Server Name', 'IP Address', 'Environment', 'Product', 'Version', 'Queue Manager', 'Status'],
                        ['MQ-PROD-01', '192.168.1.30', 'Production', 'IBM MQ', '9.2.5.0', 'QM_PROD', 'Running'],
                        ['MQ-PROD-02', '192.168.1.31', 'Production', 'IBM MQ', '9.2.5.0', 'QM_PROD2', 'Running'],
                        ['MQ-TEST-01', '192.168.2.30', 'Testing', 'IBM MQ', '9.2.4.0', 'QM_TEST', 'Running']
                    ],
                    'IIB Integration': [
                        ['Server Name', 'IP Address', 'Environment', 'Product', 'Version', 'Broker Name', 'Status'],
                        ['IIB-PROD-01', '192.168.1.40', 'Production', 'IBM Integration Bus', '10.0.0.15', 'BRK_PROD', 'Running'],
                        ['IIB-TEST-01', '192.168.2.40', 'Testing', 'IBM Integration Bus', '10.0.0.12', 'BRK_TEST', 'Running']
                    ]
                };

                // 2. Default Inventory
                const defaultInventory = {
                    'Servers': [
                        ['Server Name', 'IP Address', 'Environment', 'OS', 'CPU Cores', 'RAM (GB)', 'Status'],
                        ['SRV-PROD-01', '10.0.1.10', 'Production', 'Linux RHEL 7.9', '8', '32', 'Running'],
                        ['SRV-PROD-02', '10.0.1.11', 'Production', 'Linux RHEL 7.9', '8', '32', 'Running'],
                        ['SRV-TEST-01', '10.0.2.10', 'Testing', 'Linux RHEL 7.8', '4', '16', 'Running'],
                        ['SRV-DEV-01', '10.0.3.10', 'Development', 'Linux RHEL 7.7', '2', '8', 'Running']
                    ],
                    'Services': [
                        ['Service Name', 'Server', 'Port', 'Version', 'Status', 'Last Updated'],
                        ['Web Service API', 'SRV-PROD-01', '8080', '2.5.1', 'Running', '2024-01-15'],
                        ['Database Service', 'SRV-PROD-01', '5432', 'PostgreSQL 13.5', 'Running', '2024-01-10'],
                        ['Cache Service', 'SRV-PROD-02', '6379', 'Redis 6.2.6', 'Running', '2024-01-12'],
                        ['Web Service API', 'SRV-TEST-01', '8080', '2.5.0', 'Running', '2024-01-14']
                    ],
                    'Applications': [
                        ['Application Name', 'Server', 'Version', 'Environment', 'Status', 'Deploy Date'],
                        ['Customer Portal', 'SRV-PROD-01', '1.3.2', 'Production', 'Running', '2024-01-05'],
                        ['Payment Gateway', 'SRV-PROD-02', '2.1.0', 'Production', 'Running', '2024-01-08'],
                        ['Customer Portal', 'SRV-TEST-01', '1.3.1', 'Testing', 'Running', '2024-01-12']
                    ]
                };

                // 3. Mixed Services
                const mixedServices = {
                    'Infrastructure': [
                        ['Component', 'Server', 'IP', 'Version', 'Type', 'Environment', 'Status'],
                        ['Load Balancer', 'LB-PROD-01', '192.168.1.5', 'F5 BigIP 15.1.2', 'Network', 'Production', 'Running'],
                        ['Firewall', 'FW-PROD-01', '192.168.1.1', 'CheckPoint R80.40', 'Security', 'Production', 'Running'],
                        ['DNS Server', 'DNS-PROD-01', '192.168.1.2', 'BIND 9.16.15', 'Network', 'Production', 'Running']
                    ],
                    'Middleware': [
                        ['Service', 'Server', 'IP', 'Product', 'Version', 'Port', 'Status'],
                        ['API Gateway', 'API-PROD-01', '192.168.1.50', 'Kong', '3.0.0', '8000', 'Running'],
                        ['Message Broker', 'MB-PROD-01', '192.168.1.51', 'RabbitMQ', '3.11.5', '5672', 'Running'],
                        ['Service Mesh', 'SM-PROD-01', '192.168.1.52', 'Istio', '1.17.0', '15000', 'Running']
                    ],
                    'Databases': [
                        ['Database', 'Server', 'IP', 'Type', 'Version', 'Size (GB)', 'Status'],
                        ['Customer DB', 'DB-PROD-01', '192.168.1.60', 'PostgreSQL', '14.7', '500', 'Running'],
                        ['Analytics DB', 'DB-PROD-02', '192.168.1.61', 'MongoDB', '6.0.4', '200', 'Running'],
                        ['Cache DB', 'DB-PROD-03', '192.168.1.62', 'Redis', '7.0.8', '50', 'Running']
                    ],
                    'Monitoring': [
                        ['Tool', 'Server', 'IP', 'Product', 'Version', 'URL', 'Status'],
                        ['Monitoring', 'MON-PROD-01', '192.168.1.70', 'Prometheus', '2.42.0', 'http://192.168.1.70:9090', 'Running'],
                        ['Logging', 'LOG-PROD-01', '192.168.1.71', 'ELK Stack', '8.5.0', 'http://192.168.1.71:5601', 'Running'],
                        ['Tracing', 'TRACE-PROD-01', '192.168.1.72', 'Jaeger', '1.40.0', 'http://192.168.1.72:16686', 'Running']
                    ]
                };

                // –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
                const files = [
                    { name: 'ibm-products.xlsx', data: ibmProducts },
                    { name: 'default-inventory.xlsx', data: defaultInventory },
                    { name: 'mixed-services.xlsx', data: mixedServices }
                ];

                let created = 0;
                files.forEach(file => {
                    const wb = XLSX.utils.book_new();
                    
                    Object.keys(file.data).forEach(sheetName => {
                        const ws = XLSX.utils.aoa_to_sheet(file.data[sheetName]);
                        XLSX.utils.book_append_sheet(wb, ws, sheetName);
                    });

                    XLSX.writeFile(wb, file.name);
                    created++;
                });

                status.innerHTML = `<p class="success">‚úÖ –£—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–æ ${created} —Ñ–∞–π–ª–æ–≤!</p>
                    <p>–§–∞–π–ª—ã —Å–∫–∞—á–∞–Ω—ã –≤ –ø–∞–ø–∫—É –∑–∞–≥—Ä—É–∑–æ–∫. –ü–µ—Ä–µ–º–µ—Å—Ç–∏ –∏—Ö –≤ –ø–∞–ø–∫—É <code>test-files/</code> –ø—Ä–æ–µ–∫—Ç–∞.</p>
                    <ul>
                        <li>ibm-products.xlsx</li>
                        <li>default-inventory.xlsx</li>
                        <li>mixed-services.xlsx</li>
                    </ul>`;
            } catch (error) {
                status.innerHTML = `<p style="color: #ef4444;">‚ùå –û—à–∏–±–∫–∞: ${error.message}</p>`;
                console.error(error);
            }
        }
    </script>
</body>
</html>
